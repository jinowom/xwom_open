<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN"> <html> <head> <meta http-equiv="X-UA-Compatible" content="IE=EmulateIE7"> <meta http-equiv="Content-Type" content="text/html; charset=utf-8"> <script type="text/javascript" src="dialog.js?v=12.1"> </script> <script type="text/javascript"> document.write("<link href='../language/"+lang.bF+".css?v="+EWEB.V+"' type='text/css' rel='stylesheet'>");document.write("<link href='../skin/"+config.Skin+"/dialog.css?v="+EWEB.V+"' type='text/css' rel='stylesheet'>");var bm=lang["DlgPPT"];document.write("<title>"+bm+"</title>");var ll=(parseInt(config.WIAPI)<10)?true:false;var FE=(((config.SYWZFlag=="2"||config.SYTPFlag=="2")&&config.SYVLocal=="1")?true:false);function ok(){if(DLGRunOne.FH("btn_ok")){return;}DLGRunOne.BP("btn_ok",true);FT.wQ("isinstalled",[true],function(hT){if(!hT["Ret"]){Mh();return;}GQ();});};function GQ(){var es=$("d_file").value;if(!iV(es,"ppt|pptx|dps")){alert(lang["DlgPPTInvalidFile"]);Mh();return;}var eL=$("d_imgtype").options[$("d_imgtype").selectedIndex].value;var cw="";if(ll){if($("d_api0").checked){cw="0";}else if($("d_api1").checked){cw="1";}else{cw="2";}}else{cw=config.WIAPI.substr(1);}var bu="";bu+="api:"+cw+";";bu+="imgtype:"+eL+";";bu+="tw:"+$("d_tw").value+";";if(FE){if($("d_syflag").checked){bu+="syflag:1;";}}bB.Show();FT.wQ("importppt",[es,bu],function(hT){Io(hT);});};function Io(hT){if(hT["Error"]=="cancel"){parent.Cancel(true);return;}if(FT.Fi(hT["Error"])){Mh();return;}if(DLGRunOne.FH("btn_cancel")){parent.Cancel(true);return;}var ak="";var bC=hT["Body"];EWIN.addUploadFiles(hT["OriginalFiles"],hT["SavedFiles"]);if($("d_imgefflag").checked){bC='<div class="ewebeditor_doc" style="width:'+$('d_imgefwidth').value+';height:'+$('d_imgefheight').value+'; overflow:auto;background-color:#A0A0A3;border:1px solid #D4D0C8;text-align:center;">'+bC.replace(/(<img)(\s[^>]*?>)/gi,'$1 style="border-width:1px 2px 2px 1px;border-color:#00000;margin:5px;"$2')+'</div>';}if($("d_pos").checked){EWIN.setHTML(ak+bC,true);}else{EWIN.insertHTML(bC);if(ak){var fh=ak+EWIN.getHTML();EWIN.setHTML(fh,true);}}bB.Hide();parent.bV({flag:"AfterImportPPT",action:""});};function pf(bd,gK){pz(bd,gK,"INPUT");pz(bd,gK,"SPAN");};function pz(bd,gK,aH){var K=bd.getElementsByTagName(aH);for(var j=0;j<K.length;j++){K[j].disabled=gK;}};function pK(){var b=$("d_imgefflag").checked;pf($("group_imgef"),!b);};function Bi(){var b=$("d_twflag").checked;pf($("group_tw"),!b);};function aq(){lang.ag(document);switch(config.WIAPI){case "0":case "10":bU(0);break;case "1":case "11":bU(1);break;case "2":case "12":bU(2);break;}if(ll){$("d_api"+config.WIAPI).checked=true;}Bi();pK();parent.ar(bm);};function bU(AW){};function DO(){FT.wQ("isinstalled",[true],function(hT){if(!hT["Ret"]){return;}FT.wQ("dialogopen",[1,0,lang["DlgPPTFile"]+"(*.ppt,*.pptx,*.dps)|*.ppt;*.pptx;*.dps",1],function(hT){var es=hT["Ret"];if(es){$("d_file").value=es;}});});};function Lo(){if(DLGRunOne.FH("btn_ok")){if(DLGRunOne.FH("btn_cancel")){return;}DLGRunOne.BP("btn_cancel",true);bB.Me(true);FT.wQ("cancel",[]);}else{parent.Cancel(true);}};function Mh(){bB.Hide();DLGRunOne.BP("btn_ok",false);if(DLGRunOne.FH("btn_cancel")){bB.Me(false);DLGRunOne.BP("btn_cancel",false);}} </script> </head> <body onload="aq()"> <table border=0 cellpadding=0 cellspacing=5 id=tabDialogSize><tr><td> <table border=0 cellpadding=0 cellspacing=0 align=center> <tr> <td> <fieldset> <legend><span lang=DlgPPTLegend></span>:</legend> <table border=0 cellpadding=5 cellspacing=0 width='100%'><tr><td> <table border=0 cellpadding=0 cellspacing=2 width='100%'> <tr> <td noWrap><span lang=DlgPPTFile></span>:</td> <td noWrap width='100%'><input type=text id='d_file' size=30 style='width:255px'> <input type=button class='dlgBtnCommon dlgBtn' lang=DlgBtnBrowse onclick='DO()'></td> </tr> <script type="text/javascript"> if(ll){document.write("		<tr>");document.write("			<td noWrap><span lang=DlgPPTAPI></span>:</td>");document.write("			<td noWrap><input type=radio name=d_api id=d_api0 onclick='bU(0)' checked><label for=d_api0>"+lang["DlgPPTAPI0"]+"</label>&nbsp; <input type=radio name=d_api id=d_api1 onclick='bU(1)' checked><label for=d_api1>"+lang["DlgPPTAPI1"]+"</label>&nbsp; <input type=radio name=d_api id=d_api2 onclick='bU(2)'><label for=d_api2>"+lang["DlgPPTAPI2"]+"</label></td>");document.write("		</tr>");} </script> </table> </td></tr></table> </fieldset> </td> </tr> <tr><td height=5></td></tr> <tr> <td> <fieldset> <legend><span lang=DlgPPTOptimize></span>:</legend> <table border=0 cellpadding=5 cellspacing=0 width="100%"> <tr><td valign=top> <table border=0 cellpadding=0 cellspacing=3> <tr> <td noWrap width="20%"><span lang=DlgWordImgType></span>:</td> <td noWrap width="29%"> <select id=d_imgtype size=1 style="width:80px"> <option value='jpg'>JPG</option> <option value='png' selected>PNG</option> </select> </td> <td width="2%">&nbsp;</td> <td noWrap width="20%"></td> <td noWrap width="29%"></td> </tr> <script type="text/javascript"> if(FE){document.write("<tr><td><span lang=DlgImgSYFlag></span>:</td><td colspan=4><input type=checkbox id=d_syflag value='1'></td></tr>");} </script> <tr><td colspan=5><input type=checkbox id=d_twflag value='1' onclick='Bi()' checked><label for=d_twflag><span lang=DlgPPTtwFlag></span>:</label> <span id=group_tw><span lang=DlgPPTtw></span><input type=text size=5 id=d_tw style='width:50px' value='600' onkeydown="eR(event);">&nbsp;<span lang=DlgPPTth></span></span></td></tr> <tr><td colspan=5><input type=checkbox id=d_imgefflag value='1' onclick='pK()' checked><label for=d_imgefflag><span lang=DlgWordImgEfFlag></span>:</label> <span id=group_imgef><span lang=DlgWordImgEfWidth></span><input type=text size=5 id=d_imgefwidth style='width:50px' value='100%'>&nbsp;<span lang=DlgWordImgEfHeight></span><input type=text size=5 id=d_imgefheight style='width:50px' value=''></span></td></tr> </table> </td></tr> </table> </fieldset> </td> </tr> <tr><td height=5></td></tr> <tr> <td> <table border=0 cellpadding=0 cellspacing=0 width="100%"> <tr> <td noWrap><input type=checkbox id=d_pos checked><label for=d_pos><span lang=DlgComInsertReplace></span></label></td> <td noWrap align=right><input type=submit class="dlgBtnCommon dlgBtn" value="" id="btn_ok" onclick="ok()" lang=DlgBtnOK>&nbsp;&nbsp;<input type=button class="dlgBtnCommon dlgBtn" value="" id="btn_cancel" onclick="Lo()" lang=DlgBtnCancel></td> </tr> </table> </td> </tr> </table> </td></tr></table> <script type="text/javascript"> bB.OutHtml(lang["DlgPPTImporting"]); </script> </body> </html> 